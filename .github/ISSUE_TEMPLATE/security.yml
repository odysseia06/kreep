name: Security / Side-Channel
description: Side-channel, constant-time, misuse hazards, and cryptographic safety concerns
title: "[security] "
labels:
  - security
body:
  - type: markdown
    attributes:
      value: |
        **Disclosure note**: Do not include secrets, private keys, or sensitive tokens in this issue.
        If this is an exploitable vulnerability in a deployed system, use private responsible
        disclosure instead of a public issue. Contact the maintainers directly or use
        GitHub's private security advisory feature (Security tab > "Report a vulnerability").

        This template is for design-level safety concerns: timing leaks, misuse hazards,
        invalid-input acceptance, and constant-time contract gaps.
  - type: dropdown
    id: priority
    attributes:
      label: Priority
      description: >
        P0 = exploitable in realistic threat model.
        P1 = design gap or misuse hazard requiring documentation or mitigation.
        P2 = hardening for defense-in-depth.
      options:
        - P0-correctness/blocker
        - P1-important
        - P2-later
    validations:
      required: true
  - type: checkboxes
    id: areas
    attributes:
      label: Area labels (pick 1-3)
      options:
        - label: area:constant-time
        - label: area:field-fp
        - label: area:ext-fields
        - label: area:serialization
        - label: area:randomness
        - label: area:traits-algebra
        - label: area:docs-examples
    validations:
      required: true
  - type: dropdown
    id: class
    attributes:
      label: Security concern class
      options:
        - Timing side-channel (secret-dependent branches/memory access)
        - Data-dependent memory access pattern
        - Panic/misuse hazard (unexpected input causes crash)
        - Invalid-curve/invalid-structure acceptance
        - Serialization/deserialization trust boundary violation
        - RNG misuse or insufficient entropy
        - Other
    validations:
      required: true
  - type: textarea
    id: threat_model
    attributes:
      label: Threat model
      description: |
        Specify: what is secret, what the attacker can observe/control, and what
        deployment context is affected.
      placeholder: |
        Secret: field element used as private key
        Attacker: can measure timing of `inverse()` calls
        Context: server-side scalar multiplication
    validations:
      required: true
  - type: textarea
    id: ct_considerations
    attributes:
      label: Constant-time / side-channel considerations
      description: |
        Is the affected code path expected to be constant-time? Does it use the `subtle`
        feature? Are there known variable-time operations in the call chain?
      placeholder: |
        `Fp::inverse()` at fp.rs:982 uses extended GCD with secret-dependent loop count.
        `Fp::inverse_ct()` exists but is not used by default arithmetic operators.
    validations:
      required: false
  - type: textarea
    id: misuse
    attributes:
      label: Misuse hazards
      description: |
        How might a caller reasonably misuse this API in a security-sensitive context?
      placeholder: |
        A caller might assume that enabling the `subtle` feature makes all `Fp` operations
        constant-time, but only `pow_ct` and `inverse_ct` are actually protected.
    validations:
      required: false
  - type: textarea
    id: evidence
    attributes:
      label: Evidence
      description: File paths/line ranges and a minimal demonstration.
    validations:
      required: true
  - type: textarea
    id: mitigation
    attributes:
      label: Proposed mitigation
    validations:
      required: true
  - type: textarea
    id: dod
    attributes:
      label: Definition of Done
      placeholder: |
        - [ ] Risk reproduced and triaged
        - [ ] Mitigation implemented
        - [ ] Variable-time APIs documented with warnings
        - [ ] Tests/docs updated with security guidance
    validations:
      required: true
